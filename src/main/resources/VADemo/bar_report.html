<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <title>信用额度分布情况</title>

</head>

<style>

    * {
        font-size: 14px;
        font-family: "微软雅黑";
    }

    #content {
        height: 100%;
        width: 100%;
        margin: auto;
        text-align: center;
        background-color: #fff;
        padding-top: 30px;
    }
	#comtre{
		margin:0px 30px 30px 30px;
		box-shadow: 2px 2px 10px #888888;
	}
    .chart_box {
	 width: 48%;
        display: inline-block;
    }

    #speedometer_bar, #speedometer_radar {
        background-color: #fff;
        margin: 0px 12px 30px 12px;
		box-shadow: 2px 2px 10px #888888;
    }

    .title {
        font-size: 16px;
        color: white;
        margin-left: 12px;
        margin-right: 12px;
        padding: 10px 0px;
        text-align: left;
        text-indent: 1em;
		background-color: rgb(10, 24, 92);
	  border-top-left-radius: 5px;
	  border-top-right-radius: 5px;
		padding:10px 0px;
	
    }

    #list_box {
        width: 97%;
        color: white;
        margin: 0px 0px 0px 20px;
        text-align: center;
        padding-bottom: 30px;
		
    }

    #list {
        font-size: 16px;
        background-color: #fff;
        margin-left: 15px;
        margin-right: 15px;
        padding: 0px 20px 30px 45px;
		box-shadow: 2px 2px 10px #888888;
    }

    .title-long {
		border-top-left-radius: 5px;
	    border-top-right-radius: 5px;
        font-size: 18px;
        color: white;
        background-color:rgb(10, 24, 92);
        margin-left: 15px;
        margin-right: 15px;
        padding: 10px 0px;
        text-align: left;
        text-indent: 2.5em;
    }

    table tr td {
        border: 1px solid #424562;
        width: 300px;
        height: 60px;
		 color: #666;
    }
	#tab{
		margin:auto;
	}

    .tb_title, #tb_title {
        color: #666;
    }

    /*坐标轴样式*/
    .axis-x path,
    .axis-x line {
        fill: none;
        stroke: #7e8083;
        shape-rendering: crispEdges;
    }

    .axis-x text {
        fill: #7e8083;
        font-family: sans-serif;
        font-size: 11px;
    }

    .axis-y path,
    .axis-y line {
        fill: none;
        stroke: #7e8083;
        shape-rendering: crispEdges;
    }

    .axis-y text {
        fill: #7e8083;
        font-family: sans-serif;
        font-size: 12px;
    }

    .axispath,
    .axis line {
        fill: none;
        stroke: #424562;
        shape-rendering: crispEdges;
    }

    .axis text {
        fill: #7e8083;
        font-family: sans-serif;
        font-size: 11px;
    }

    /* 提示框样式 */
    .tooltip {
        position: absolute;
        padding: 05px;
        width: auto;
        height: auto;
        font-family: simsun;
        font-size: 14px;
        text-align: center;
        fill: white;
        /*stroke:#63676c ;*/
        /*border: 1px solid none;*/
        background-color: #63676c;
        border-radius: 5px;
        display: block;
    }

    .tooltip:after {
        content: '';
        position: absolute;
        bottom: 100%;
        left: 20%;
        margin-left: -8px;
        width: 0;
        height: 0;
        border-bottom: 1px solid black;
        border-right: 1px solid transparent;
        border-left: 1px solid transparent;
    }


</style>

<body>
<div id="content">
    <div class="chart_box">
        <div class="title">信用额度分布 - 客户量</div>
        <div id="speedometer_bar"></div>
    </div>
    <div class="chart_box">
		<div id="comtre"></div>
        <div class="title">信用额度分布 - 客户占比</div>
        <div id="speedometer_radar"></div>
    </div>

    <div id="list_box">
        <div class="title-long">零售信用贷款新增情况</div>
        <div id="list">
            <table id="tab">
                <tr id="tb_title">
                    <td class="tb_title">信用额度<br>Credit Limit</td>
                    <td class="tb_title">客户数<br>Customers</td>
                    <td class="tb_title">占比<br>Customer Percentage</td>
                </tr>
                <tr>
                    <td class="tb_title">[0,5K)</td>
                    <td>30000</td>
                    <td>6.52%</td>
                </tr>
                <tr>
                    <td class="tb_title">[5K,10K)</td>
                    <td>70000</td>
                    <td>15.22%</td>
                </tr>
                <tr>
                    <td class="tb_title">[5K,10K)</td>
                    <td>70000</td>
                    <td>15.22%</td>
                </tr>
                <tr>
                    <td class="tb_title">[10K,20K)</td>
                    <td>100000</td>
                    <td>21.74%</td>
                </tr>
                <tr>
                    <td class="tb_title">[20K,30K)</td>
                    <td>120000</td>
                    <td>26.09%</td>
                </tr>
                <tr>
                    <td class="tb_title">[30K,50K)</td>
                    <td>70000</td>
                    <td>15.22%</td>
                </tr>
                <tr>
                    <td class="tb_title">[50,100K)</td>
                    <td>40000</td>
                    <td>8.70%</td>
                </tr>
                <tr>
                    <td class="tb_title">[100K,+)</td>
                    <td>30000</td>
                    <td>6.52%</td>
                </tr>
                <tr>
                    <td class="tb_title">合计 Total</td>
                    <td>460000</td>
                    <td>100.00%</td>
                </tr>
            </table>
        </div>
    </div>
</div>
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/img-common.css">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" >

bar();
radar();
function bar(){
       var da=[
			{x0:"[0,5k)",客户量:30000},
			{x0:"[5k,10k)",客户量:70000},
			{x0:"[10k,20k)",客户量:100000},
			{x0:"[20k,30k)",客户量:120000},
			{x0:"[30k,50k)",客户量:70000},
			{x0:"[50k,100k)",客户量:40000},
			{x0:"[100k,+)",客户量:30000}
	   ];
		var bar={
					axisColor: null,
					axisLabelColor: null,
					axisLabelFontFamily: null,
					axisLabelFontSize: null,
					axisRotate: 0,
					axisTickColor: null,
					background: "#fff",
					barName: "信用额度分布-客户量",
					baseId: "a8b561067e834ef7ac08ffac7ecab902",
					createTime: "2018-09-10 17:32:19",
					createUser: "管理员",
					fontColor: "#000",
					fontFamily: "微软雅黑",
					fontSize: 14,
					fontWeight: "noraml",
					height: 420,
					hoverfill: "red",
					hoverfillOpacity: 0.8,
					id: 53,
					legendDx: 2,
					legendDy: 50,
					legendFontColor: null,
					legendFontSize: null,
					legendSize: null,
					marBottom: 450,
					marLeft: 40,
					marRight: 20,
					marTop: 20,
					padBottom: 50,
					padLeft: 70,
					padRight: 40,
					padTop: 50,
					rectPadding: 0.1,
					rectWidth: 0.5,
					rectfill: "#D43239,#FDC800,#00A7EE,#2F8F1F,#0067BB,#38ABB8,#E1B81B",
					rectfillOpacity: 0.8,
					stroke: "#FFF",
					strokeOpacity: 0.8,
					titleDx: 1,
					titleDy: 1,
					updateTime: "2018-09-19 11:01:09",
					width: 480,
					x: 1,
					xOrient: "bottom",
					xTextAnchor: "middle",
					xTickpadding: 5,
					xTicks: 2,
					xTicksize: 5,
					xTitle: " ",
					xTitleDx: 1,
					xTitleDy: 1,
					y: 1,
					yOrient: "left",
					yTextAnchor: "middle",
					yTickpadding: 5,
					yTicks: 5,
					yTicksize: 5,
					yTitle: " ",
					yTitleDx: 2,
					yTitleDy: 0
			}
            var colum = [];
            Object.keys(da[0]).forEach(function (key, i, v) {
                colum.push(key)
            });
            da.columns = colum;
            //
            var margin = {top: bar.padTop, right: bar.padRight, bottom: bar.padBottom, left: bar.padLeft};
            var width = bar.width;
            var height = bar.height;

            d3.select("#speedometer_bar").select("svg").remove();
            var svg = d3.select("#speedometer_bar").append("svg")
                .attr("width", width)
                .attr("height", height)
                .style("background-color", bar.background);


            width = svg.attr("width") - margin.left - margin.right;
            height = svg.attr("height") - margin.top - margin.bottom;
            var g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            //color数组
            /*var color=[];
            color=bar.rectfill;
            var color_ary=color.split(",");*/
            var color_ary = ["#D43239", "#FDC800", "#00A7EE", "#2F8F1F", "#0067BB", "#38ABB8", "#E1B81B"];

            var x0 = d3.scaleBand()
                .rangeRound([0, width])
                .paddingInner(bar.rectWidth);

            var x1 = d3.scaleBand()
                .padding(bar.rectPadding);

            var y = d3.scaleLinear()
                .rangeRound([height, 0]);

            var z = d3.scaleOrdinal()
                .range(color_ary);

            var keys = da.columns.slice(1);

            /*var yAxis=d3.svg.axis()
                .scale(y)
                .orient(bar.yOrient)
                .ticks(2);*/
            /*var xAxis=d3.svg.axis()
            .scale(x0)
            .orient(bar.xOrient)
            .ticks(2);*/

            x0.domain(da.map(function (d) {
                return d.x0;
            }));
            x1.domain(keys).rangeRound([0, x0.bandwidth()]);
            y.domain([0, d3.max(da, function (d) {
                return d3.max(keys, function (key) {
                    return d[key];
                });
            })]).nice();

            g.append("g")
                .selectAll("g")
                .data(da)
                .enter().append("g")
                .attr("transform", function (d) {
                    return "translate(" + x0(d.x0) + ",0)";
                })
                .attr("fill", function (d, i) {
                    return z(i);
                })
                .selectAll("rect")
                .data(function (d) {
                    return keys.map(function (key) {
                        return {key: key, value: d[key]};
                    });
                })
                .enter().append("rect")
                .attr("x", function (d) {
                    return x1(d.key);
                })
                .attr("y", function (d) {
                    return y(d.value);
                })
                .attr("width", x1.bandwidth())
                .attr("height", 0)
                .attr("fill-opacity", bar.rectfillOpacity)
                .transition().duration(500)
                .attr("height", function (d) {
                    return height - y(d.value);
                });

            //提示框
            var tooltip = d3.select("body")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0.0);

            var rect = d3.selectAll("rect");
            rect.on("mouseover", function (d, i) {
                tooltip.html("</p>" + d.key + ":" + d.value+"<p>")
                    .style("left", (d3.event.pageX) + "px")
                    .style("top", (d3.event.pageY) + "px")
                    .style("opacity", 1.0)
                    .style("background-color","#63676c")
                    .style("font-family","MicrosoftYaHei")
                    .style("font-size","14px")
                    .style("color","#FFF")
                    .style("border-radius","5px");
            })
                .on("mousemove", function (d) {
                    tooltip.style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY + 20) + "px");
                })
                .on("mouseout", function (d) {
                    tooltip.style("opacity", 0.0);

                });

            g.append("g")
                .attr("class", "axis-x")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(x0).ticks(bar.xTicks).tickSize(bar.xTicksize))
                .append("text")
                .attr("x", width + bar.padRight)
                .attr("y", -2)
                .attr("dy", bar.xTitleDy + "em")
                .attr("dx", bar.xTitleDx + "em")
                .attr("fill", "#FFF")
                .style("font-size", bar.fontSize + "px")
                .attr("font-weight", "bold")
                .attr("text-anchor", bar.xTextAnchor)
                .text(bar.xTitle);

            g.append("g")
                .attr("class", "axis-y")
                .call(d3.axisLeft(y).ticks(bar.yTicks).tickSize(bar.yTicksize))
                .append("text")
                .attr("x", 2)
                .attr("y", y(y.ticks().pop()) + 0.5)
                .attr("dy", bar.yTitleDy + "em")
                .attr("dx", bar.yTitleDx + "em")
                .attr("fill", "#FFF")
                .attr("font-weight", "bold")
                .attr("text-anchor", bar.yTextAnchor)
                .text(bar.yTitle)
                .style("font-size", bar.fontSize + "px")
                .style("font-fimaly", bar.fontFamily)


            var legend = svg.append("g")
                .attr("font-family", "sans-serif")
                .attr("font-size", bar.fontSize)
                .attr("text-anchor", "end")
                .selectAll("g")
                .data(keys.slice().reverse())
                .enter().append("g")
                .attr("transform", function (d, i) {
                    return "translate(0," + i * 20 + ")";
                })
                .attr("dx", bar.legendDx + "em")
                .attr("dy", bar.legendDy + "em");
            ;
}

function radar(){
		  var datanum=[[
						  {axis:"[0,5k)",value:"30000"},
						  {axis:"[5k,10k)",value:"70000"},
						  {axis:"[10k,20k)",value:"100000"},
						  {axis:"[20k,30k)",value:"120000"},
						  {axis:"[30k,50k)",value:"70000"},
						  {axis:"[50k,100k)",value:"40000"},
						  {axis:"[100k,+)",value:"30000"}
						]]
		  var radar={
			axisColor: "white",
			axisSize: 2,
			baseId: "7bea7c92ca214a0694891011847beda7",
			canvasColor: "#fff",
			circleBorderColor: "#CDCDCD",
			circleFillColor: "#CDCDCD",
			doRadiusClarity: 0.8,
			dotRadius: 4,
			fontAlign: "middle",
			fontFamily: "arial,微软雅黑",
			fontSize: 12,
			forma: "0",
			height: 420,
			id: 6,
			isCurve: "0",
			labelFactor: 1.25,
			labelHeight: 1.4,
			levs: 4,
			maValue: 0.5,
			opacityArea: 0.6,
			opacityCircles: 0.1,
			padBottom: 80,
			padLeft: 100,
			padRight: 100,
			padTop: 70,
			radarName: "信用额度分布 -客户占比",
			radius: 200,
			scaleFamily: "arial,微软雅黑",
			scaleSize: 12,
			selectedClarity: 0.7,
			strockWidth: 2,
			unselectedClarity: 0.2,
			width: 480
		};
		   var formas = '';
            if (radar.forma == "1") {
                formas = '%';
            }
            var ra = radar.radius;
            var fontFamily = radar.fontFamily;
            var scaleFamily = radar.scaleFamily;
            var datas = datanum;
            var f = true;
            if (radar.isCurve == "0") {
                f = false;
            }
            var margin = {
                top: parseInt(radar.padTop),
                right: parseInt(radar.padRight),
                bottom: parseInt(radar.padBottom),
                left: parseInt(radar.padLeft)
            };
            //////////////////////////////////////////////////////////////
            ////////////////////////// Data //////////////////////////////
            //////////////////////////////////////////////////////////////

            //////////////////////////////////////////////////////////////
            //////////////////// Draw the Chart //////////////////////////
            //////////////////////////////////////////////////////////////

            var color = d3.scaleOrdinal().range(
                ["#3080ff", "#0cf1d9", "#ff5b8d", "#955bff"]); //每个区域的颜色属性

            var radarChartOptions = {
                w: radar.width - margin.left - margin.right,
                h: radar.height - margin.top - margin.bottom,
                margin: margin,
                maxValue: radar.maValue,
                levels: parseInt(radar.levs),
                roundStrokes: f, //是否采用光滑曲线
                color: color
            };
            RadarChart("#speedometer_radar", datas, radarChartOptions);

            function RadarChart(id, data, options) {
                var cfg = {
                    w: 600, //宽度
                    h: 400, //高度
                    margin: {
                        top: 100,
                        right: 100,
                        bottom: 100,
                        left: 100
                    }, //画布和页面的边距
                    levels: 3, //有多少层内圈
                    maxValue: 0, //最大的圈的代表值
                    labelFactor: radar.labelFactor, //标签距外圆半径的位置
                    wrapWidth: 60, //标签之后的新线的像素数
                    opacityArea: radar.opacityArea, //每个区域的不透明度
                    dotRadius: radar.dotRadius, //每个数据点的大小
                    opacityCircles: radar.opacityCircles, //每个圆圈的不透明度
                    strokeWidth: radar.strockWidth, //数据区域的边框线宽度
                    roundStrokes: false, //是否使用光滑曲线
                    color: d3.scaleOrdinal(d3.schemeCategory10)
                    //每个区域的颜色属性
                };

                //Put all of the options into a variable called cfg
                if ('undefined' !== typeof options) {
                    for (var i in options) {
                        if ('undefined' !== typeof options[i]) {
                            cfg[i] = options[i];
                        }
                    }//for i
                }//if

                //如果传递过来的数据最大值大于默认的最大值，用其将默认值替换
                var maxValue = Math.max(cfg.maxValue, d3.max(data, function (i) {
                    return d3.max(i.map(function (o) {
                        return parseFloat(o.value);
                    }))
                }));
                var allAxis = (data[0].map(function (i, j) {
                        return i.axis
                    })), //坐标轴名称
                    total = allAxis.length, //坐标轴数量
                    radius = Math.min(cfg.w / 2, cfg.h / 2, radar.radius), //最外层圆的半径
                    Format = d3.format(formas), //数据的展示样式
                    angleSlice = Math.PI * 2 / total; //每个部分的弧度宽度

                //半径的规模
                var rScale = d3.scaleLinear().range([0, radius]).domain(
                    [0, maxValue]);

                /////////////////////////////////////////////////////////
                //////////// Create the container SVG and g /////////////
                ////////////////////Format/////////////////////////////////////

                //Remove whatever chart with the same id/class was present before
                d3.select(id).select("svg").remove();

                //Initiate the radar chart SVG
                var svg = d3.select(id).append("svg").attr("width",
                    cfg.w + cfg.margin.left + cfg.margin.right).attr("height",
                    cfg.h + cfg.margin.top + cfg.margin.bottom).attr("class",
                    "radar" + id).style("background-color",
                    radar.canvasColor); //画布背景颜色
                //Append a g element
                var g = svg.append("g").attr(
                    "transform",
                    "translate(" + (cfg.w / 2 + cfg.margin.left) + ","
                    + (cfg.h / 2 + cfg.margin.top) + ")");

                /////////////////////////////////////////////////////////
                ////////// Glow filter for some extra pizzazz ///////////
                /////////////////////////////////////////////////////////

                //Filter for the outside glow
                var filter = g.append('defs').append('filter').attr('id', 'glow'), feGaussianBlur = filter
                    .append('feGaussianBlur').attr('stdDeviation', '2.5').attr(
                        'result', 'coloredBlur'), feMerge = filter
                    .append('feMerge'), feMergeNode_1 = feMerge.append(
                    'feMergeNode').attr('in', 'coloredBlur'), feMergeNode_2 = feMerge
                    .append('feMergeNode').attr('in', 'SourceGraphic');

                /////////////////////////////////////////////////////////
                /////////////// Draw the Circular grid //////////////////
                /////////////////////////////////////////////////////////

                //Wrapper for the grid & axes
                var axisGrid = g.append("g").attr("class", "axisWrapper");
                //Draw the background circles
                axisGrid.selectAll(".levels").data(
                    d3.range(1, (cfg.levels + 1)).reverse()).enter().append(
                    "circle").attr("class", "gridCircle").attr("r",
                    function (d, i) {
                        return radius / cfg.levels * d;
                    }).style("fill", radar.circleFillColor) //圆圈的填充颜色
                    .style("stroke", radar.circleBorderColor) //圆圈的边框颜色
                    .style("fill-opacity", cfg.opacityCircles).style("filter",
                    "url(#glow)");

                //Text indicating at what % each level is
                axisGrid.selectAll(".axisLabel").data(
                    d3.range(1, (cfg.levels + 1)).reverse()).enter().append(
                    "text").attr("class", "axisLabel").attr("x", 4).attr("y",
                    function (d) {
                        return -d * radius / cfg.levels;
                    }).attr("dy", "0.4em").style("font-family",
                    radar.scaleFamily) //刻度文字样式
                    .style("font-size", radar.scaleSize + "px") //刻度文字大小
                    .attr("fill", "#7e8083").text(function (d, i) {
                    return Format(maxValue * d / cfg.levels);
                });

                /////////////////////////////////////////////////////////
                //////////////////// Draw the axes //////////////////////
                /////////////////////////////////////////////////////////

                //Create the straight lines radiating outward from the center
                var axis = axisGrid.selectAll(".axis").data(allAxis).enter()
                    .append("g").attr("class", axis);
                //Append the lines
                axis.append("line").attr("x1", 0).attr("y1", 0).attr(
                    "x2",
                    function (d, i) {
                        return rScale(maxValue * 1.1)
                            * Math.cos(angleSlice * i - Math.PI / 2);
                    }).attr(
                    "y2",
                    function (d, i) {
                        return rScale(maxValue * 1.1)
                            * Math.sin(angleSlice * i - Math.PI / 2);
                    }).attr("class", "line").style("stroke",
                    radar.axisColor) //轴线的颜色
                    .style("stroke-width", radar.axisSize + "px"); //轴线的宽度像素

                //Append the labels at each axis
                axis.append("text").attr("class", "legend").style("font-family",
                    radar.fontFamily) //文本字体样式
                    .style("font-size", radar.fontSize + "px") //文本字体大小
                    .attr("text-anchor", radar.fontAlign) //文本对齐方式
					.attr("fill", "#7e8083")
                    .attr("dy", "0.35em").attr(
                    "x",
                    function (d, i) {
                        return rScale(maxValue * cfg.labelFactor)
                            * Math.cos(angleSlice * i - Math.PI / 2);
                    }).attr(
                    "y",
                    function (d, i) {
                        return rScale(maxValue * cfg.labelFactor)
                            * Math.sin(angleSlice * i - Math.PI / 2);
                    }).text(function (d) {
                    return d
                }).call(wrap, cfg.wrapWidth);

                /////////////////////////////////////////////////////////
                ///////////// Draw the radar chart blobs ////////////////
                /////////////////////////////////////////////////////////

                //The radial line function
                var radarLine = d3.radialLine()//svg.line.radial().interpolate("linear-closed")
                    .radius(function (d) {
                        return rScale(d.value);
                    }).angle(function (d, i) {
                        return i * angleSlice;
                    });

                if (cfg.roundStrokes) {
                   radarLine.curve(d3.curveCardinalClosed)
                }

                //Create a wrapper for the blobs
                var blobWrapper = g.selectAll(".radarWrapper").data(data).enter()
                    .append("g").attr("class", "radarWrapper");

                //Append the backgrounds
                blobWrapper.append("path").attr("class", "radarArea").attr("d",
                    function (d, i) {
                        return radarLine(d);
                    }).style("fill", function (d, i) {
                    return cfg.color(i);
                }).style("fill-opacity", 0).transition().style("fill-opacity", cfg.opacityArea);
                d3.selectAll(".radarArea").on(
                    'mouseover',
                    function (d, i) {
                        //Dim all blobs
                        d3.selectAll(".radarArea").transition().duration(500)
                            .style("fill-opacity",
                                radar.unselectedClarity); //选中某一区域时其他区域的透明度
                        //Bring back the hovered over blob
                        d3.select(this).transition().duration(500).style(
                            "fill-opacity", radar.selectedClarity); //选中的区域透明度
                    }).on(
                    'mouseout',
                    function () {
                        //Bring back all blobs
                        d3.selectAll(".radarArea").transition().duration(500)
                            .style("fill-opacity", cfg.opacityArea); //鼠标移出时颜色恢复
                    });
                //Create the outlines
                blobWrapper.append("path").attr("class", "radarStroke").attr("d",
                    function (d, i) {
                        return radarLine(d);
                    }).style("stroke-width", cfg.strokeWidth + "px").style(
                    "stroke", function (d, i) {
                        return cfg.color(i);
                    }).style("fill", "none").style("filter", "url(#glow)");

                //Append the circles
                blobWrapper.selectAll(".radarCircle").data(function (d, i) {
                    return d;
                }).enter().append("circle").attr("class", "radarCircle").attr("r", 0).transition().attr("r",
                    cfg.dotRadius).attr(
                    "cx",
                    function (d, i) {
                        return rScale(d.value)
                            * Math.cos(angleSlice * i - Math.PI / 2);
                    }).attr(
                    "cy",
                    function (d, i) {
                        return rScale(d.value)
                            * Math.sin(angleSlice * i - Math.PI / 2);
                    }).style("fill", function (d, i, j) {
                    return cfg.color(j);
                }).style("fill-opacity", radar.doRadiusClarity); //数据点填充的透明度

                /////////////////////////////////////////////////////////
                //////// Append invisible circles for tooltip ///////////
                /////////////////////////////////////////////////////////

                //Wrapper for the invisible circles on top
                var blobCircleWrapper = g.selectAll(".radarCircleWrapper").data(
                    data).enter().append("g").attr("class",
                    "radarCircleWrapper");

                //Append a set of invisible circles on top for the mouseover pop-up
                blobCircleWrapper
                    .selectAll(".radarInvisibleCircle")
                    .data(function (d, i) {
                        return d;
                    })
                    .enter()
                    .append("circle")
                    .attr("class", "radarInvisibleCircle")
                    .attr("r", cfg.dotRadius * 1.5)
                    .attr(
                        "cx",
                        function (d, i) {
                            return rScale(d.value)
                                * Math
                                    .cos(angleSlice * i - Math.PI
                                        / 2);
                        })
                    .attr(
                        "cy",
                        function (d, i) {
                            return rScale(d.value)
                                * Math
                                    .sin(angleSlice * i - Math.PI
                                        / 2);
                        })
                    .style("fill", "none")
                    .style("pointer-events", "all")
                    .on(
                        "mouseover",
                        function (d, i) {
                            newX = parseFloat(d3.select(this).attr('cx')) - 10;
                            newY = parseFloat(d3.select(this).attr('cy')) - 10;
                            tooltip.attr('x', newX).attr('y', newY).text(
                                Format(d.value)).transition().duration(
                                500).style('opacity', 1);
                        }).on("mouseout", function () {
                    tooltip.transition().duration(500).style("opacity", 0);
                });

                //当鼠标悬停在某一数据点时的数据提示
                var tooltip = g.append("text").attr("class", "tooltip").style(
                    "opacity", 0);

                /////////////////////////////////////////////////////////
                /////////////////// Helper Function /////////////////////
                /////////////////////////////////////////////////////////

                //Taken from http://bl.ocks.org/mbostock/7555321
                //Wraps SVG text
                function wrap(text, width) {
                    text.each(function () {
                        var text = d3.select(this), words = text.text()
                                .split(/\s+/).reverse(), word, line = [], lineNumber = 0,
                            lineHeight = radar.labelHeight, // 标签行高ems
                            y = text.attr("y"), x = text.attr("x"), dy = parseFloat(text
                                .attr("dy")), tspan = text.text(null)
                                .append("tspan").attr("x", x).attr("y", y)
                                .attr("dy", dy + "em");

                        while (word = words.pop()) {
                            line.push(word);
                            tspan.text(line.join(" "));
                            if (tspan.node().getComputedTextLength() > width) {
                                line.pop();
                                tspan.text(line.join(" "));
                                line = [word];
                                tspan = text.append("tspan").attr("x", x)
                                    .attr("y", y).attr(
                                        "dy",
                                        ++lineNumber * lineHeight
                                        + dy + "em").text(
                                        word);
                            }
                        }
                    });
                }//wrap

            }//RadarChart
}
</script>
</body>
</html>