<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>贷款行业分布情况</title>
</head>
<body>
	<style>
#content{
	height:100%;
	width:100%;
	margin:0 auto;
	text-align:center;
	background-color:#fff; /* #0e131a */
	padding-top:30px;
}

#ringpie,#speedometer2,#speedometer3{
	background-color: #fff;
	margin:0px 30px 30px 30px;
	box-shadow: 2px 2px 10px #888888;
}
.title{
	font-size: 14px;
	color:white;
	background-color: rgb(10, 24, 92);
	  border-top-left-radius: 5px;
	  border-top-right-radius: 5px;
	margin-left:30px;
	margin-right:30px;
	padding:10px 0px;
	text-align: left;
	text-indent: 1em;
}

#list_box{
	color:white;
	margin:0 auto;
	text-align:center;
	padding-bottom:30px;
}
#list{
	background-color: #fff;
	margin-left:30px;
	margin-right:30px;
	box-shadow: 2px 2px 10px #888888;
}
.tb_title,#tb_title{
	color:#7a7b89;
}
.tb_title{
	width:150px;
}
#tb_title{
	height:45px;
}

#tab{
	text-align:center;
}
table tr td{
	border:1px solid #424562;
	width:250px;
	height:20px;
	color:#666
}

	rect {
			stroke-width: 2;
			cursor: pointer;
		}
		
	rect.disabled {
			fill: transparent !important;
		}
/* 鍧愭爣杞存牱寮� */
.axis path,
.axis line{
    fill: none;
    stroke: #6A6C7D;
    shape-rendering: crispEdges;
    cursor: pointer;
}
.axis text {
	fill:#E3E3E7;
    font-family: sans-serif;
    font-size: 11px;
}

</style>
	
	
<body>

<div id="content">
 	<div class="chart_box">
 		<div class="title"> 行业分布 - 客户量 Customer Distribution by Industry</div>
        <div id="ringpie"></div>
    </div>
   
    <div id="list_box">
    	<div class="title">贷款行业分布情况 Retail Loan Distribution by Industry</div>
    	<div id="list">
    		<table id="tab">
    			<tr id="tb_title">
                    <td rowspan=2 style="width: 300px;">产品类别<br>Product Type</td>
                    <td rowspan=2 style="width: 600px;">行业类别<br>Industry</td>
                    <td colspan=4 ><span style='mso-spacerun:yes'>&nbsp; </span>时间 Date: 2018年5月8日</td>
          
    			</tr>
    			<tr id='tb_title'>
                     <td class=x47 style='width: 100px;'>存量客户数<br>Customers</td>
                     <td class=x47 style='overflow:hidden;width: 100px;'>客户占比<br>Customer<br>Percentage</td>
                     <td class=x47 style='overflow:hidden;width: 100px;'>余额<br>Principal</td>
                     <td class=x47 style='overflow:hidden;width: 100px;'>余额占比<br>Principal<br>Percentage</td>
                </tr>
                 <tr height=16 class=x35 style='mso-height-source:userset;height:35.1pt' id='r29'>
                     <td rowspan=14 height=653 class=x61 id=tb_title >个人经营性贷款<br>Personal Business Loan &amp; SME</td>
                     <td class=x48 id=tb_title>制造业</td>
                     <td class=x49>90</td>
                     <td class=x50 >7.49%</td>
                     <td class=x48>100000</td>
                     <td class=x50>0.97%</td>                     
                </tr>
                <tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r30'>
					<td class=x48 id=tb_title>房地产业</td>
					<td class=x49>112</td>
					<td class=x50>9.33%</td>
					<td class=x48>800000</td>
					<td class=x50>7.73%</td>
				</tr>
                 <tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r31'>
					<td class=x48 id=tb_title>租赁和商务服务业</td>
					<td class=x48>124</td>
					<td class=x51>10.32%</td>
					<td class=x48>650000</td>
					<td class=x51>6.28%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r32'>
					<td class=x48 id=tb_title>批发和零售业</td>
					<td class=x49>45</td>
					<td class=x50>3.75%</td>
					<td class=x48>300000</td>
					<td class=x50>2.90%</td>
				</tr>
			    <tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r33'>
					<td class=x48 id=tb_title>采矿业</td>
					<td class=x49>78</td>
					<td class=x50>6.49%</td>
					<td class=x48>200000</td>
					<td class=x50>1.93%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r34'>
					<td class=x48 id=tb_title>交通运输、仓储和邮政业</td>
					<td class=x49>47</td>
					<td class=x50>3.91%</td>
					<td class=x48>440000</td>
					<td class=x50>4.25%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r35'>
					<td class=x48 id=tb_title>水利、环境和公共设施管理业</td>
					<td class=x49>72</td>
					<td class=x50>6.00%</td>
					<td class=x48>780000</td>
					<td class=x50>7.54%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r36'>
					<td class=x48 id=tb_title>电力、燃气及水的生产和供应业</td>
					<td class=x49>93</td>
					<td class=x50>7.74%</td>
					<td class=x48>960000</td>
					<td class=x50>9.28%</td>
			    </tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r37'>
					<td class=x48 id=tb_title>建筑业</td>
					<td class=x49>105</td>
					<td class=x50>8.74%</td>
					<td class=x48>1200000</td>
					<td class=x50>11.59%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r38'>
					<td class=x48 id=tb_title>公共管理和社会组织</td>
					<td class=x49>119</td>
					<td class=x50>9.91%</td>
					<td class=x48>690000</td>
					<td class=x50>6.67%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r39'>
					<td class=x48 id=tb_title>教育和社会服务业</td>
					<td class=x49>68</td>
					<td class=x50>5.66%</td>
					<td class=x48>880000</td>
					<td class=x50>8.50%</td>
				 </tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r40'>
					<td class=x48 id=tb_title>金融业</td>
					<td class=x49>77</td>
					<td class=x50>6.41%</td>
					<td class=x48>1800000</td>
					<td class=x50>17.39%</td>
				</tr>
				<tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r41'>
					<td class=x48 id=tb_title>信息传输、计算机服务和软件业</td>
					<td class=x49>91</td>
					<td class=x50 >7.58%</td>
					<td class=x48>740000</td>
					<td class=x50 >7.15%</td>
				</tr>
			    <tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r42'>
					<td class=x48 id=tb_title>其他</td>
					<td class=x49>80</td>
					<td class=x50>6.66%</td>
					<td class=x48>810000</td>
					<td class=x50>7.83%</td>
				</tr>
			    <tr height=46 class=x35 style='mso-height-source:userset;height:35.1pt' id='r43'>
					<td colspan=2 class=x62 id=tb_title >合计Total</td>
					<td class=x49 >1201</td>
					<td class=x50 >100.00%</td>
					<td class=x48>10350000</td>
					<td class=x51 >100.00%</td>
				</tr>
    		</table>
    	</div>
    </div>
    
</div>    
 <link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/img-common.css">
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" >  
	var data1=[
		{x0: "制造业", y0: 90},
		{x0: "房地产业", y0: 112},
		{x0: "租赁和商务服务业", y0: 124},
		{x0: "批发和零售业", y0: 45},
		{x0: "采矿业", y0: 78},
		{x0: "交通运输、仓储和邮政业", y0: 47},
		{x0: "水利、环境和公共设施管理业", y0: 72},
		{x0: "电力、燃气及水的生产和供应业", y0: 93},
		{x0: "建筑业", y0: 105},
		{x0: "公共管理和社会组织", y0: 119},
		{x0: "教育和社会服务业", y0: 68},
		{x0: "金融业", y0: 77},
		{x0: "信息传输、计算机服务和软件业", y0: 91},
		{x0: "其他", y0: 80}]
	var piep={
		height: 600,
		id: "16",
		innerRadius: 150,
		labelsDisplay: 1,
		labelsFont: "宋体",
		labelsFontColor: "#3d4f5e",
		labelsFontSize: 10,
		labelsLocation: "center",
		outerRadius: 190,
		padBottom: 20,
		padLeft: 90,
		padRight: 20,
		padTop: 20,
		pictureFont: "宋体",
		pictureFontColor: "#6a234b",
		pictureFontSize: 15,
		pictureSymbol: null,
		pieName: "ringpie",
		title: null,
		titleColor: "#8c0a4b",
		titleFont: "宋体",
		titleFontSize: 20,
		titleLocation: "center",
		width: 800
	}
	
	pieP(data1,piep)
	function pieP(data,pieattr){

 			var piep=pieattr,jsdata=data;
 			
 			d3.select("#ringpie").select("svg").remove();
			
									/*var svg = d3.select(vm.label)
												.append("svg")
												.append("g");
										
											
									d3.select(vm.label).select("svg")
										.attr("width", width-100)
										.attr("height", height)
										.style("background-color","#13163b");
									
									d3.select("svg").remove();*/
									
 			var datax=[];// 提取x轴数据
 			var datay=[];// 提取y轴数据
 			var mm=toData();
 			var data=targetToArray(datax,datay);
 			var colordata=[];
 			for(var i=0;i<data.length;i++){
 				var d=data[i][0];
 				colordata.push(d);
 			}
		
		// var margin={left:90,right:20,top:20,bottom:20};
		var width  = piep.width;// - piep.padLeft -piep.padRight;
									// //SVG绘制区域的宽度
		var height = piep.height;// - piep.padTop - piep.padBottom;
									// //SVG绘制区域的高度
		
		var svg = d3.select("#ringpie")			// 选择<body>
					// .select("div.col-sm-6 height-auto")
					.append("svg")
					.append("g")
					.attr("transform","translate("+( width/3 )+","+ ( height/2.5) +")");	
					
		var slices=svg.append("g")
		  		.attr("class","slices");
		var labelText=svg.append("g")
		  		.attr("class","labelText");
		var labelLine=svg.append("g")
				.attr("class","labelLine");
		
         d3.select("svg") // 在<body>中添加<svg>
         	.attr("width", width) // 设定<svg>的宽度属性
         	.attr("height", height-100)// 设定<svg>的高度属性
         	.style("background-color","#fff");					
					
		
		
		// 1.确定初始数据
		var dataset =data;
			// [ ["租赁和商务服务业",124] , ["批发和零售业",45] , ["采矿业",78] ,
			// ["交通运输、仓储和邮政业",47] ,
			// ["水利、环境和公共设施管理也",72] , ["电力、燃气及水的生产和供应",93] , ["建筑业",105] ];
		
		// 2.转换数据
		var pie = d3.layout.pie()
					.value(function(d){ return d[1]; });					
		var piedata = pie(dataset);
		console.log(piedata);			
		// 3.绘制			
		// 字体大小
		var fontsize = piep.labelsFontSize;	
		// 外半径和内半径
		var outerRadius = piep.outerRadius;
		var innerRadius = piep.innerRadius;		
		// 创建弧生成器
		var arc = d3.svg.arc()
					.innerRadius(innerRadius)
					.outerRadius(outerRadius);
		var arcA= d3.svg.arc()
					.innerRadius(0)
					.outerRadius(outerRadius);
		
		var largeArc=d3.svg.arc()
						.innerRadius(innerRadius)
						.outerRadius(outerRadius+15);					
		// var color = d3.scale.category20();
		var color = d3.scale.ordinal()
		  				.domain(piedata)
		  				.range(["#0098d9", "#e6b600" , "#c12e34", "#339ca8", "#005eaa","#2b821d","#32a487","#cda819"]);			
		var arcs = svg.select(".slices").selectAll(".arc")
						.data(pie(dataset));			
		var path=svg.select(".slices").selectAll(".arc")
		 		.data(pie(dataset))
		 		.enter()
		 		.append("path")
		 		.attr("class","arc");
		path.attr("id",function(d){ return d.data[0];})
			.attr("fill",function(d,i){
				return color(d.data[0]);	// 设定弧的颜色
			})
			.attr("d",function(d){
				return arc(d);	// 使用弧生成器（角度转化为弧度）
			})
			.each(function(d) { this._current = d;});// console.log(d);
		
		// 初始化动画
		path.transition()
			.duration(500)
			.ease("easeExp")
			.attrTween("d", tweenPie);
			
		// 添加一个提示框
		var tooltip = d3.select("body")
							.append("div")
							.attr("class","tooltip")
							.style("opacity",0.0)
							
		
		path.on("mouseover",function(d){
				/*
				 * 鼠标移入时， （1）通过 selection.html() 来更改提示框的文字 （2）通过更改样式 left 和
				 * top 来设定提示框的位置 （3）设定提示框的透明度为1.0（完全不透明）
				 */
				
				tooltip.html(" 存量客户数 Customers"+"<br/>"+d.data[0] + ":" + d.data[1] + "")//+ "<br/>" 
					.style("left", (d3.event.pageX) + "px")
					.style("top", (d3.event.pageY + 20) + "px")
					.style("opacity",1.0)
					.style("font-size","14px")// piep.toolTipFontSize
					.style("background","#63676c")// piep.toolTipbgcolor
					.style("color","#fff")
					.style('font-weight','normal')
					.style('font-stretch','normal')
					.style('letter-spacing','0px')
					.style('border-radius','5px')
					.style('text-align','center')
					.style("font-famliy","MicrosoftYaHei");// piep.tooltipFont
				
					
				d3.select(this).transition()// 选择节点设置
                  .duration(300)
                  .ease('elastic')
                  .attr('d', largeArc)
				
                 var currPath=d3.select(this);
				 var darkenedColor=d3.rgb(color(d.data[0])).brighter(0.2);// brighter()
					currPath.attr('fill',darkenedColor);
			})
			.on("mousemove",function(d){
				/* 鼠标移动时，更改样式 left 和 top 来改变提示框的位置 */
				
				tooltip.style("left", (d3.event.pageX) + "px")
						.style("top", (d3.event.pageY + 20) + "px");
			})
			.on("mouseout",function(d){
				/* 鼠标移出时，将透明度设定为0.0（完全透明） */
				d3.select(this).transition()
					.duration(300)
					.ease('elastic')
					.attr('d', arc)
				var currPath=d3.select(this);
				var darkenedColor=d3.rgb(color(d.data[0])).brighter(0);// brighter()
				currPath.attr('fill',darkenedColor);
				
				tooltip.style("opacity",0.0);
			});
		
		function tweenPie(b) {
			b.innerRadius = 0;
			var i = d3.interpolate({startAngle: 0, endAngle: 0}, b);
			return function(t) { return arc(i(t)); };
		};
		
		var legendRectSize = 18,
        legendSpacing  = 4; 
		// 图例
		var legend=svg.selectAll('.legend')
			.data(colordata)
            .enter()
			.append('g')
			.attr('class','legend')
			.attr('transform', function(d, i) {

			var height = legendRectSize + legendSpacing,
				offset = height * color.domain().length / 2,
				horz   = -2 * legendRectSize,
				vert   = i * height+100 - offset-100;
				return 'translate(' + 350 + ',' + (vert+20) + ')';

        });
		
		var lA=svg.select(".labelLine").append("g").attr("class","lA");
		var lB=svg.select(".labelLine").append("g").attr("class","lB");	
			
		legend.append('rect')
			 .attr('width', 23)
			 .attr('height', 16)
			 .attr('rx',3)
			 .attr('ry',3)
			 .style('fill', color)
			 .style('stroke', color)
			 .on('mouseover',function(d){
					var currPath=d3.select(this);
				    var darkenedColor=d3.rgb(color(d)).brighter(0.4);// brighter()
				        currPath.style('fill',darkenedColor);
				    var path1=d3.select(this.parentNode.parentNode).select('.slices').select('#'+d);
				        path1.transition()// 选择节点设置
	                         .duration(300)
	                         .ease('elastic')
	                         .attr('d', largeArc)
				 })
			 .on('mouseout',function(d){
					 var currPath=d3.select(this);
					 var darkenedColor=d3.rgb(color(d)).brighter(0);// brighter()
					     currPath.style('fill',darkenedColor); 
					 var path1=d3.select(this.parentNode.parentNode).select('.slices').select('#'+d);
					     path1.transition()// 选择节点设置
		                      .duration(300)
		                      .ease('elastic')
		                      .attr('d', arc)
				 })
			.on('click', function(d1) {
					// console.log(d1+"---------------");
					 var data1;
					 var rect = d3.select(this);// 当前dom元素
					 var pl=d3.select(this.parentNode.parentNode).select();
					 var enabled = true;
					
					 var totalEnabled = d3.sum(dataset.map(function(d) {
						// console.log(d);
						return (d[2]) ? 1 : 0;
					 }));
				
					 if (rect.attr('class') === "disabled") {
						 rect.attr('class', '');
					 } else {
						 if (totalEnabled < 2) return;
							rect.attr('class', 'disabled');
							enabled = false;
					}
					// 重新排序
					pie.value(function(d,i) {
						if (d[0] === d1) d[2] = enabled;
						return (d[2]) ? d[1] : 0;
					});
					
					var temp=[];
					
				   update();
					function update(){
						path = path.data(pie(dataset));
						path.transition()
							.duration(300)
							.ease("easeExp")
							.attrTween('d', function(d) {
								var interpolate = d3.interpolate(this._current, d);
								this._current = interpolate(0);
								return function(t) {
									return arc(interpolate(t));
								};
							});
						path.exit().remove();
					}
				  lA=svg.select(".labelLine").select(".lA");
				  lB=svg.select(".labelLine").select(".lB");
				  //console.log(lA);
                  updataLinesAndText(dataset); 
            });
			 
		svg.selectAll('.legend')
			.data(pie(dataset))
			.append('text')
			.attr('x', 25)// 图例字体与图例水平距离
			.attr('y', 13)// 图例字体竖直距离
			.text(function(d) {
				// console.log(d.data);d.data表示数组中的一个对象；d表示数组；d.data.type表示数组中每个对象的属性
				return d.data[0];
			})
			.attr('fill','#666')
			.attr('font-size','12px');
			
		
		updataLinesAndText(dataset);		
	function updataLinesAndText(dd){
		    
			var text = svg.select(".labelText").selectAll("text")
					  .data(pie(dd));
			// 绘制弧内的文字
				text.enter()
					.append("text")
				text.attr("transform",function(d){
						var x = arcA.centroid(d)[0] * 1.7;		// 文字的x坐标
						var y = arcA.centroid(d)[1] * 1.7;		// 文字的y坐标
						return "translate(" + x + "," + y + ")";
					})
				.attr("text-anchor","middle")
				.style("font-size",fontsize)
				.text(function(d){
						// 计算市场份额的百分比
						var percent = Number(d.value)/d3.sum(dd,function(d){ return d[1]; }) * 100;
						// 保留1位小数点，末尾加一个百分号返回
						return percent.toFixed(2) + "%";
					})
				.style('opacity',.0);
				text.exit().remove();
			// 添加直线弧外连接元素
		
			var lineA = lA.selectAll("line")
					  .data(pie(dd));
				lineA.enter().append("line")
		
				lineA.transition().duration(500).attr("class","lineA")
					 .attr("stroke",function(d,i){return color(d.data[0]);})
					 .attr("x1",function(d){return arcA.centroid(d)[0]*2;})// 连接直线是否在圆弧内
					 .attr("y1",function(d){return arcA.centroid(d)[1]*2;})
					 .attr("x2",function(d){return arcA.centroid(d)[0]*2.3;})// 连接直线长度
					 .attr("y2",function(d){return arcA.centroid(d)[1]*2.3;});
				lineA.exit().remove();
		
			var lineB = lB.selectAll("line")
						.data(pie(dd));	
				lineB.enter().append("line");
				lineB.transition().duration(500).attr("class","lineB")
					.style("stroke",function(d,i){return color(d.data[0]);})
					.each(function(d){
							d.textLine = {x1:0, y1:0, x2:0, y2:0};
						})
					.attr("x1",function(d){ 
							d.textLine.x1 = arcA.centroid(d)[0] * 2.3;
							return d.textLine.x1; 
						})
					.attr("y1",function(d){ 
							d.textLine.y1 = arcA.centroid(d)[1] * 2.3;
							return d.textLine.y1; 
						})
					.attr("x2",function(d){ 
							// console.log(d.data[0]);
							var strLen = getPixelLength(d.data[0],fontsize) * 1.5;
							var bx = arcA.centroid(d)[0] * 2.3;
							d.textLine.x2 =	bx >= 0 ? bx + strLen : bx - strLen;	
							return d.textLine.x2;
						})
					.attr("y2",function(d){
							d.textLine.y2 =	arcA.centroid(d)[1] * 2.3;
							return d.textLine.y2; 
					});	
				lineB.exit().remove();
			// 绘制弧外的文字
			var lineC=lB.selectAll("text").data(pie(dd));
		 
				lineC.enter().append("text");
				lineC.transition().duration(500).attr("class","textOUT")
					 .attr("transform",function(d){
						 var x1 = arcA.centroid(d)[0] * 2.3;
						 var strLen = getPixelLength(d.data[0],fontsize) * 1.5;
						 var bx = arcA.centroid(d)[0] * 2.3;
						 var	x2 =	bx >= 0 ? bx + strLen : bx - strLen;
						 var y1 = arcA.centroid(d)[1] * 2.3;			   
						 var x = 0;
						 var y = 0;
						     x = ( x1 + x2 ) / 2 ;
							 y = y1;
							 y = y > 0 ? y + fontsize * 0.8+3 : y - fontsize * 0.4;
						return "translate(" + x + "," + y + ")";
					 })
					.style("text-anchor","middle")
					.style("font-size",fontsize)
					.style('fill','#666')
					.text(function(d){
						return d.data[1];
					});
				lineB.exit().remove();
		function getPixelLength(str,fontsize){
			var curLen = 0;
			for(var i=0;i<str.length;i++){
				var code = str.charCodeAt(i);
				var pixelLen = code > 255 ? fontsize : fontsize/2;
				curLen += pixelLen;
			}
			// console.log(curLen);
			return 15;
		}
	}
		function toData(){	
				var n=0;
					
				for(var a=0;a<jsdata.length;a++){//数组长度
						var data1="";
						for(var i=0;i<Object.keys(jsdata[0]).length;i++){//对象长度
									var xb=Object.keys(jsdata[a]).some(key => key.includes('x'+i));
									var yb=Object.keys(jsdata[a]).some(key => key.includes('y'+i));										
										if(xb==true & Object.keys(jsdata[0]).length != 2){
											data1+=jsdata[a]['x'+i]+"_";
											//console.log(data1);
										}if(xb==true & Object.keys(jsdata[0]).length == 2){
											data1+=jsdata[a]['x'+i];
										}if(xb==false & i!=1 & i!=0){
											if(i%2==0 & i!=2){
					                           n=i-1; 
											}else{
											   n=i;
											}	
										}if(xb==false & i==1 ||xb==false & i==0){
											n=1;
										}			
							};
							if(Object.keys(jsdata[0]).length != 2){
								data1 = data1.substring(0, data1.lastIndexOf('_'));
								datax.push(data1);
							}else{
								datax.push(data1);
							}
					};
					//console.log(datax);
					//console.log(n);
					for(var i=0;i<Object.keys(jsdata[0]).length-n;i++){
						  datay[i]=[]; 
					}
					for(var a=0;a<jsdata.length;a++){//数组长度
							var data2;
							for(var i=0;i<Object.keys(jsdata[0]).length;i++){//对象长度
										var xb=Object.keys(jsdata[a]).some(key => key.includes('x'+i));
										var yb=Object.keys(jsdata[a]).some(key => key.includes('y'+i));
										if(yb==true){
											    var dsd;
											    data2=jsdata[a]['y'+i];
											    if((typeof data2)=='string' && data2.indexOf("%") != -1){
											    	console.log(11)
											    	d3d=Number(data2.substring(0,data2.lastIndexOf('%')));
											    	//console.log(typeof data2);
											    }else{
											    	d3d=Number(data2);
											    	//console.log(typeof d3d);
											    }
												//console.log(data2);
												datay[i].push(d3d);		
										};				
							};
					};
				}
				
				//后台数据转为数组:[[],[],...]
				function targetToArray(datax,datay){
					 
					var dataset=[];
					//for(var i=0;i<datay.length;i++){
					 //   dataset[i]=[];
					//}
					for(var i=0;i<datax.length;i++){
					     for(var j=0;j<datay.length;j++){
					        var obj=[
					            datax[i],
					            datay[j][i],
					            true
					        ]
					        dataset.push(obj);
					    }
					 
					}
					return dataset;
				}
				//后台数据转为数组对象:[{},{},...]
				function targetToObject(datax,datay){
					var dataset=[];//封装数据				
					for(var i=0;i<datay.length;i++){
						dataset[i]=[];
					}
					for(var i=0;i<datax.length;i++){
					     for(var j=0;j<datay.length;j++){
							var obj={
								angle:1,
								type:datax[i],
								value:datay[j][i],
								enabled:true
							}
							dataset[j].push(obj);
						}

					}
					//console.log(dataset);
					
					return dataset;
				}
     
	}
	</script>	
</body>
</html>